<?xml version="1.0" encoding="US-ASCII"?>


<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [ 
<!-- One method to get references from the online citation libraries. 
     There has to be one entity for each item to be referenced.  
     An alternate method (rfc include) is described in the references.
-->
<!--
<!ENTITY RFC1027 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.1027.xml">
<!ENTITY RFC2234 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2234.xml">
<!ENTITY RFC3513 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3513.xml">
<!ENTITY RFC4861 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4861.xml">
<!ENTITY RFC4941 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4941.xml">
<!ENTITY RFC6830 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6830.xml">
<!ENTITY RFC6831 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6831.xml">
<!ENTITY RFC6832 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6832.xml">
<!ENTITY RFC6833 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6833.xml">
<!ENTITY RFC6835 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6835.xml">
<!ENTITY RFC6836 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6836.xml">
<!ENTITY RFC7215 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.7215.xml">
<!ENTITY RFC8060 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8060.xml">
<!ENTITY RFC8061 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8061.xml">
<!ENTITY RFC8111 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8111.xml">
<!ENTITY RFC8112 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8112.xml">
<!ENTITY I-D.draft-ietf-spring-segment-routing SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-spring-segment-routing-15.xml">
<!ENTITY I-D.draft-ietf-6man-segment-routing-header SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-6man-segment-routing-header-08.xml">
<!ENTITY I-D.draft-ietf-dmm-srv6-mobile-uplane SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-dmm-srv6-mobile-uplane-01.xml">
<!ENTITY I-D.draft-filsfils-spring-srv6-network-programming SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-filsfils-spring-srv6-network-programming-04.xml">
<!ENTITY I-D.draft-xuclad-spring-sr-service-chaining SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-xuclad-spring-sr-service-chaining-01.xml">
<!ENTITY I-D.draft-farinacci-lisp-mobile-network SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-farinacci-lisp-mobile-network-02.xml">
<!ENTITY I-D.draft-ietf-lisp-eid-mobility SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-lisp-eid-mobility-00.xml">
<!ENTITY I-D.draft-ietf-lisp-pubsub SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-lisp-pubsub-00.xml">
<!ENTITY I-D.draft-rodrigueznatal-ila-lisp SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-rodrigueznatal-ila-lisp-01.xml">
<!ENTITY I-D.draft-kouvelas-lisp-map-server-reliable-transport SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-kouvelas-lisp-map-server-reliable-transport-04.xml">
<!ENTITY I-D.draft-gundavelli-dmm-mfa SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-gundavelli-dmm-mfa-00.xml">
<!ENTITY I-D.draft-ietf-lisp-rfc6830bis SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-lisp-rfc6830bis-12.xml">
<!ENTITY I-D.draft-ietf-lisp-rfc6833bis SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-lisp-rfc6833bis-10.xml">
<!ENTITY I-D.draft-ietf-lisp-mn SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-lisp-mn-02.xml">
<!ENTITY I-D.draft-ietf-lisp-introduction SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-lisp-introduction-13.xml">
<!ENTITY I-D.draft-herbert-intarea-ila SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-herbert-intarea-ila-00.xml">
<!ENTITY I-D.draft-herbert-ila-ilamp SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-herbert-ila-ilamp-00.xml">
<!ENTITY I-D.draft-lapukhov-bgp-ila-afi SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-lapukhov-bgp-ila-afi-02.xml">
<!ENTITY I-D.draft-homma-dmm-5gs-id-loc-coexistence SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-homma-dmm-5gs-id-loc-coexistence-01.xml">
-->
<!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY I-D.draft-bogineni-dmm-optimized-mobile-user-plane SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-bogineni-dmm-optimized-mobile-user-plane-00.xml">

]> 
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?> 
<!-- used by XSLT processors --> 
<!-- For a complete list and description of processing instructions (PIs),  
      please see http://xml.resource.org/authoring/README.html. --> 
<!-- Below are generally applicable Processing Instructions (PIs) that most I-Ds might want to use. 
     (Here they are set differently than their defaults in xml2rfc v1.32) --> 
<?rfc strict="yes" ?> 
<!-- give errors regarding ID-nits and DTD validation --> 
<!-- control the table of contents (ToC) --> 
<?rfc toc="yes"?> 
<!-- generate a ToC --> 
<?rfc tocdepth="4"?> 
<!-- the number of levels of subsections in ToC. default: 3 --> 
<!-- control references --> 
<?rfc symrefs="yes"?> 
<!-- use symbolic references tags, i.e, [RFC2119] instead of [1] --> 
<?rfc sortrefs="yes" ?>

<!-- sort the reference entries alphabetically --> 
<!-- control vertical white space  
     (using these PIs as follows is recommended by the RFC Editor) --> 
<?rfc compact="yes" ?> 
<!-- do not start each main section on a new page --> 
<?rfc subcompact="no" ?> 
<!-- keep one blank line between list items --> 
<!-- end of list of popular I-D processing instructions --> 


<rfc category="info" docName="draft-hmm-dmm-5g-uplane-analysis">
  <!-- ***** FRONT MATTER ***** --> 




  <front>
    <title abbrev="draft-hmm-dmm-5g-uplane-analysis-00">
    User Plane Protocol and Architectural Analysis on 3GPP 5G System
    </title>



    <author fullname="Shunsuke Homma" initials="S." surname="Homma">
      <organization>NTT</organization>

      <address>
        <postal>
          <street/>
          <city/>
          <region/>
          <code/>
          <country/>
        </postal>
        <email>homma.shunsuke@lab.ntt.co.jp</email>
      </address>
    </author>


    <author fullname="Takuya Miyasaka" initials="T." surname="Miyasaka">
      <organization>KDDI Research</organization>

      <address>
        <postal>
          <street/>
          <city/>
          <region/>
          <code/>
          <country/>
        </postal>
        <email>ta-miyasaka@kddi-research.jp</email>
      </address>
    </author>
    
    <author fullname="Satoru Matsushima" initials="S." surname="Matsushima">
      <organization>SoftBank</organization>

      <address>
        <postal>
          <street/>
          <city/>
          <region/>
          <code/>
          <country/>
        </postal>
        <email>satoru.matsushima@g.softbank.co.jp</email>
      </address>
    </author>

    
    <date year="2018"/>

    <area>Internet Area</area>

    <workgroup>dmm</workgroup>
    
    <keyword>I-D</keyword>

    <abstract>
        <t>
            This document analyzes the mobile user plane protocol and the
            architecture specified in 3GPP 5G documents. The analysis work is to
            clarify those specifications and to extract protocol and
            architectural requirements in terms of user plane from IETF side
            that is corresponding to the User Plane Protocol Study work on 3GPP
            side.
        </t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>
        This document analyzes the mobile user plane protocol and the
        architecture specified by 3GPP 5G documents. The background of the work
        is that 3GPP requests through a liaison statement that the IETF to
        provide any information for the User Plane Protocol Study work in 3GPP
        <xref target="CP-180116-3GPP"/>. Justification and the objectives of the
        study can be found from <xref target="CP-173160-3GPP"/>.
      </t>
      
      <t>
        To provide adequate information for 3GPP, we need to clearly understand
        what the current user plane protocol in 5G is, and architectural
        requirements for the user plane.  As the liaison statement indicates 3GPP
        specifications related to user plane, those documents set should be a
        good start point to clarify their specifications and to extract protocol
        and architectural requirements from them.
      </t>
    
      <t>
        First, we analyze <xref target="TS.29.281-3GPP">GTP-U</xref> for
        clarifying it as the current user plane protocol in the 5G system. <xref
        target="TR.29.891-3GPP"/> describes how GTP-U is selected as the user
        plane protocol for 5G in 3GPP. GTP-U has been developed by 3GPP from
        previous generations, and it is widely deployed in existing mobile
        service networks.  Clarified characteristics of the protocol are
        described in <xref target="gtp-u"/>. 
      </t>
      
      <t>
        Then, to clarify what are required to the user plane protocol in
        architecture level, we analyze <xref target="TS.23.501-3GPP"/> as the
        5G system architecture specification. <xref target="TS.23.502-3GPP"/> is
        the specification of system procesures that helps us to understand how
        the system works in the architecture. <xref target="TS.23.503-3GPP"/> is
        also helpful to find the role of user plane in the architecture that
        influences user plane protocol. Extracted architectural requirements are
        described in <xref target="arch"/>.
      </t>

      <t>
        Based on the results of above, we finally figure out an idea of
        evaluation criteria for user plane protocols in <xref
        target="criteria"/>. That's we intend to be as a part of the reply to
        3GPP. CT4 WG in 3GPP can utilize it as an input to evaluate the
        candidate protocols for user plane to the 5G system including current
        protocol. <xref target="I-D.bogineni-dmm-optimized-mobile-user-plane"/>
        will provide the candidate protocols on IETF side to the 3GPP study.
      </t>
    </section>
      
    <section title="Terms">
      <t>
      This document refers the terminologies of functions and interfaces defined in 
      <xref target="TS.23.501-3GPP"/> and <xref target="TS.23.502-3GPP"/>.
      </t>

      <t>
      This document mainly focuses on UPP, and this section describes terminologies of functions and 
      interfaces relevant to UPP.
      <list style="hanging">
        <t hangText="PDU session:">
        Association between the UE and a Data Network that provides a PDU connectivity service.
        </t>

        <t hangText="User Plane Fuction (UPF):">
        An UPF handles the PDU sessions. An UPF is connected to SMF with N4 interface. The 5G system allows 
        to deploy two types of UPF; central UPF and local UPF. More detailed information is described in 
        <xref target="TS.23.501-3GPP"/>. 
        </t>

        <t hangText="Radio Access Network (RAN):">
        A RAN is an access network where radio bearer sent by UEs traverse. A RAN encapsulate users' packets 
        with any encapsulation such as GTP-U.
        </t>

        <t hangText="Session Management Fuction (SMF):">
        An SMF is a function which provides control plane functionalities for handling PDU sessions.
        </t>

<!-- You can add terminologies which are important in this document -->

      </list>
      </t>
    </section>


    <section anchor="gtp-u" title="GTPv1-U">
      <section title="Current Status of Mobile User Plane for 5G">
        <t>
          GTP is abbreviation of GPRS Tunneling Protocol and GTPv1-U is a user-plane specific protocol which is defined in <xref target="TS.29.281-3GPP" />.
          Unless there is no specific annotation, we refer to GTPv1-U as GTP-U in this document.
        </t>
        <t>
          3GPP RAN and CT4 decided to use GTP-U as the 5G user plane encapsulation protocol over N3 and N9
          respectively <xref target="TS.38.300-3GPP" /> <xref target="TR.29.891-3GPP" />.N3 is a interface between RAN and UPF and N9 is a interface between different UPFs <xref target="TS.23.501-3GPP" />.
          This section describes specifications of GTP-U and summarize the characteristic of GTP-U to see if GTP-U meets the requirements of 5G architecture for user plane in later section.
        </t>
      </section>
      <section title="GTP-U Specification">
        <section title="GTP-U Tunnel">
          <t>
            GTP-U is a tunneling protocol between GTP-U peers and encapsulate T-PDU from UE with UDP+IP. <xref target="fig_Protocol-Stack"/> shows an example for protocol stack of GTP-U.
            RAN node encapsulates the IP packet from UE with GTP-U header, IPv4 or IPv6, and UDP. In this example there are two GTP-U tunnel : (1) GTP-U Tunnel between RAN and UPF1 (Signalled TEID=1)
            and (2) GTP-U Tunnel between UPF1 and UPF2 (Signalled TEID=2).
          </t>
          <figure anchor="fig_Protocol-Stack" title="Protocol Stack by GTPv1-U">
            <artwork align="center"><![CDATA[

               N3                   N9
          GTP-U Tunnel         GTP-U Tunnel
           (TEID=1)              (TEID=2)
       <---------------->   <---------------->
  +-----+             +------+             +------+
  | RAN |-------------| UPF1 |-------------| UPF2 |
  +-----+             +------+             +------+

         +-----------+        +-----------+
         |    L1     |        |    L1     |
         +-----------+        +-----------+
         |    L2     |        |    L2     |
         +-----------+        +-----------+
         | IPv4/IPv6 |        | IPv4/IPv6 |
         +-----------+        +-----------+
         |    UDP    |        |    UDP    |         +-----------+
         +-----------+        +-----------+         |     L1    |
         | GTP-U Hdr |        | GTP-U Hdr |         +-----------+
         | (TEID=1)  |        | (TEID=2)  |         |     L2    |
         +-----------+        +-----------+         +-----------+
         | IPv4/IPv6 |        | IPv4/IPv6 |         | IPv4/IPv6 |
         +-----------+        +-----------+         +-----------+
         |    App    | -----> |    App    | ------> |    App    | ------>
         +-----------+        +-----------+         +-----------+

 ]]></artwork>
          </figure>
        </section>
        <section title="GTP-U Header Format">
          <t>
            <xref target="fig_GTP-U_header" /> shows general and mandatory GTP-U header and <xref target="fig_GTP-U_Ext_header"/> shows extension GTP-U header.
            The Tunnel Endpoint ID (TEID) which is present in the GTP-U header shall indicate which tunnel a particular T-PDU belongs to.
            TEID is signalled to GTP-U tunnel endpoint nodes from control plane function by using control plane protocol.
            In current 5G architecture, the control plane function is SMF and PFCP (Packet Forwarding Control Plane) is selected as the control plane protocol for N4 interface <xref target="TR.29.891-3GPP" />.
          </t>
            <figure anchor="fig_GTP-U_header" title="GTP-U Header">
            <artwork align="center"><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | Ver |P|R|E|S|N| Message Type|             Length              |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                Tunnel Endpoint Identifier                     |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |      Sequence Number        |   N-PDU Number  |  Next-Ext-Hdr |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

 o Ver: Version field (Set to '1')
 o P: Protocol Type (Set to '1')
 o R: Reserved bit (Set to '0')
 o E: Extension Header Flag (Set to '1' if extension header exists)
 o S: Sequence Number Flag (Set to '1' if sequence number exists)
 o N: N-PDU Number Flag (Set to '1' if N-PDU number exists)
 o Message Type: Indicates the type of GTP-U message
 o Length: Indicates the length in octets of the payload
 o Tunnel Endpoint Identifier (TEID)
 o Sequence Number: Indicates increasing sequence number for T-PDUs is transmitted via GTP-U tunnels
 o N-PDU Number: It is used only for inter SGSN, 2G-3G handover case, etc.
 o Next-Ext-Hdr: Indicates following extension header type

]]></artwork>
          </figure>
          <t>
            The extension GTP-U header is a variable-length and extendable header and contains 3GPP specific information which is listed in <xref target="fig_GTP-U_Ext_Hdr_List" />.

          <figure anchor="fig_GTP-U_Ext_header" title="Extension GTP-U Header">
          <artwork align="center"><![CDATA[
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | Ext-Hdr Length|                                               |
 +-+-+-+-+-+-+-+-+                                               |
 |                  Extension Header Content                     |
 .                                                               .
 .                                               +-+-+-+-+-+-+-+-+
 |                                               |  Next-Ext-Hdr |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 o Ext-Hdr Length: The length of the Extension header shall be defined in a variable length of 4 octets
 o Extension Header Content: Contains 3GPP related information
 o Next-Ext-Hdr: Indicates following extension header type

]]></artwork>
          </figure>

          <figure anchor="fig_GTP-U_Ext_Hdr_List" title="Definition of Extension Header Type">
          <artwork align="center"><![CDATA[

 +-----------------------------------+--------------------------------+
 | Next Extension Header Field Value | Type of Extension Header       |
 +-----------------------------------+--------------------------------+
 |           0000 0000               | No more extension headers      |
 +-----------------------------------+--------------------------------+
 |           0000 0001               | Reserved - Control Plane only  |
 +-----------------------------------+--------------------------------+
 |           0000 0010               | Reserved - Control Plane only  |
 +-----------------------------------+--------------------------------+
 |           0010 0000               | Service Class Indicator        |
 +-----------------------------------+--------------------------------+
 |           0100 0000               | UDP Port                       |
 +-----------------------------------+--------------------------------+
 |           1000 0001               | RAN Container                  |
 +-----------------------------------+--------------------------------+
 |           1000 0010               | Long PDCP PDU Number           |
 +-----------------------------------+--------------------------------+
 |           1000 0011               | Xw RAN Container               |
 +-----------------------------------+--------------------------------+
 |           1000 0100               | NR RAN Container               |
 +-----------------------------------+--------------------------------+
 |           1000 0101               | PDU Session Container          |
 +-----------------------------------+--------------------------------+
 |           1100 0000               | PDCP PDU Number                |
 +-----------------------------------+--------------------------------+
 |           1100 0001               | Reserved - Control Plane only  |
 +-----------------------------------+--------------------------------+
 |           1100 0010               | Reserved - Control Plane only  |
 +-----------------------------------+--------------------------------+

]]></artwork>
        </figure>
        </t>
        </section>
        <section title="Control Plane for GTP-U">
          <t>
            TBD
          </t>
        </section>
        <section title="GTP-U OAM Message">
          <t>
            TBD
          </t>
        </section>
      </section>
      <section title="Observations on GTP-U Specification">
        <t>
          This section lists observations on GTP-U specification.
          <list style="hanging">
            <t hangText="GTP-U-1:">
              GTP-U is a Point-to-Point tunneling protocol. This characteristic is described in section 4.2.1 of <xref target="TS.29.281-3GPP" />.
              GTP-U tunnel is established between a given pair of tunnel endpoint nodes by using control plane protocol which signals common TEID value toward these two tunnel endpoint nodes.
            </t>

            <t hangText="GTP-U-2:">
              GTP-U supports Point-to-Multipoint tunneling. This characteristic is described in section 4.2.6 of <xref target="TS.29.281-3GPP" />.
              Multicast GTP-U tunnel is established from one sender node to multiple receiver nodes. This multicast GTP-U tunnel is used for MBMS(Multimedia Broadcast Multicast Service).
            </t>

            <t hangText="GTP-U-3:">
              GTP-U has no indication of next-header type.
              Receiving tunnel endpoint node can't identify which type of protocol exists under GTP-U encapsulation, this is because Next Header Tyoe information isn't encoded in GTP-U header.
              Therefore, control plane protocol must need to inform the PDU session type to GTP-U tunnel endpoint nodes.
              GTP-U header format is described in section 5.1 of <xref target="TS.29.281-3GPP" />.
            </t>

            <t hangText="GTP-U-4:">
              GTP-U has sequence number option and sequence number flag nu in the header, but it is not recommended to be used by almost GTP-U entities.
              However, sequence number flag should be set to "0" in normal case, this means receiving tunnel endpoint node doesn't examine sequence number and reorder GTP-U packets based on the sequence number.
              The sequence number flag is set to "1" only for RAT HO procedure.
              This specification is described in section 5.1 of <xref target="TS.29.281-3GPP" />.
            </t>

            <t hangText="GTP-U-5:">
              "GTP-U supports carrying QoS Identifiers transparently for Access Networks in extension headers.
              PDU Session Container extension header carries QFI for NGRAN of 5G. This PDU Session Container is described in section 5.2.2.7 of <xref target="TS.29.281-3GPP" />.
              In this manner, GTP-U can carry 3GPP specific information by using extension header.
            </t>

            <t hangText="GTP-U-6:">
              GTP-U supports active OAM as a path management message "Echo Request/Response".
              GTP-U has Echo Request message and Echo Response message to find out if a GTP-U tunnel is alive.
              Echo Request message and Echo Response message are described in section 7.2.1 and section 7.2.2 of <xref target="TS.29.281-3GPP" /> respectively.
              Echo Request sending interval is recommended to be less than 60 seconds on each path.
            </t>

            <t hangText="GTP-U-7:">
              GTP-U supports tunnel management messages "End Marker".
              GTP-U has End Marker message to indicate the end of the payload stream that needs to be sent on a GTP-U tunnel.
              End Marker message is described in section 7.3.2 of <xref target="TS.29.281-3GPP" />.
            </t>

            <t hangText="GTP-U-8:">
              GTP-U supports tunnel management messages "Error Indication".
              GTP-U has Error Indication message to notify that the receiving endpoint discard packets of which no session exist to the sending endpoint.
              Error Indication message is described in section 7.3.1 of <xref target="TS.29.281-3GPP" />.
            </t>

            <t hangText="GTP-U-9">
              GTP-U supports DSCP marking based on the QCI.
              DSCP marking on outer IPv4 or IPv6 shall be set by sender tunnel endpoint node based on the QCI.
              This specification is described in section 4.4.1 of <xref target="TS.29.281-3GPP" />.
              However 5G QoS model is different from QCI and utilize QFI (QoS Flow ID), so <xref target="TS.29.281-3GPP" /> may have to be revised to support DSCP marking based on "QFI" for 5G.
            </t>

            <t hangText="GTP-U-10:">
              GTP-U does not support UDP zero checksum in IPv6 transport case.
              Outer IPv6 protocol in GTP-U is based on RFC2460. This specification is described in section 4.2.3 of <xref target="TS.29.281-3GPP" />.
              However RFC 2460 is obsoleted by RFC8200. Thus GTP-U doesn't support new feature which is introduced in RFC8200 like UDP zero checksum.
            </t>

            <t hangText="GTP-U-11:">
              GTP-U endpoint does not support to response ICMP PTB for PMTUD.
            </t>

            <t hangText="GTP-U-12:">
              GTP-U supports load balancing by using dynamic UDP port allocation.
            </t>

            </list>
          </t>
        </section>
    </section>


    <section anchor="arch" title="5GS Architectural Requriements for User Plane Protocols">

      <section title="Overview of 5G System Architecture">
      <t>
      The 5G system is designed for applying to diverse devices and services such, and the UPP is 
      required to have capabilities for saticefying their requirements. For example, a 5G system is expected to 
      provide the feasibility includes network slicing, network capability exposure, etc. (Ref. 
      <xref target="TS.22.261-3GPP"/>)
      </t>
    
      <t>
      The 5G system is defined as a service-based architecture, and PDU sessions are available to be controlled 
      from other authorized network functions via control plane functions. The architecture overview is shown in 
      <xref target="fig_3GPP-5GS-ARCH"/>. The details of functions are described in <xref target="TS.23.501-3GPP"/>.
      </t>

<figure anchor="fig_3GPP-5GS-ARCH"
        title="5GS Architecture and Service-based Interfaces">
  <artwork><![CDATA[


   +-----+  +-----+  +-----+     +-----+  +-----+  +-----+
   |NSSF |  | NEF |  | NRF |     | PCF |  | UDM |  | AF  |
   +--+--+  +--+--+  +--+--+     +--+--+  +--+--+  +--+--+
 Nnssf|    Nnef|    Nnrf|       Npcf|    Nudm|        |Naf
   ---+--------+--+-----+--+--------+--+-----+--------+-
             Nausf|    Namf|       Nsmf|
               +--+--+  +--+--+     +--+--+
               |AUSR |  | AMF |     | SMF |
               +-----+  +--+--+     +-----+
                          /|           |
Control Plane          N1/ |N2         |N4

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
User Plane            /    |           |
                  N1 /     |N2         |N4
                    /      |           |
                 +-+-+  +--+--+ N3  +--+--+ N6  +----+
                 |UE +--+(R)AN+-----+ UPF +-----+ DN |
                 +---+  +-----+     ++--+-+     +----+
                                     |  |
                                     +--+
                                      N9


 ]]></artwork>
</figure>

<!-- Should we add a figure of protocol stacks? -->


      <t>
      This document mainly focuses on requirements for N9 interface as relevant to UPP of 5G system.
      </t>
      </section>


      <section title="Architectural Requirements for User Plane Protocols">
      <t>
      This section lists the requirements for the UPP on the 5G system. The requirements are picked 
      up from <xref target="TS.23.501-3GPP"/>. In addition, some of service requirements described in 
      <xref target="TS.22.261-3GPP"/> are referred to clarify the originations of architectural requirements.
      </t>
    
      <t>
      According to <xref target="TS.23.501-3GPP"/>, the specifications potentially have assumptions that the user 
      plane protocol is a tunnel representing a single TEID between a pair of UPFs and it is corresponding to a 
      single PDU session. In short, the UPP is a tunnel and it is assumed to be managed under per 
      PDU session handling. Also, it should be a stateful tunnel in the UPFs along with the PDU session.
      </t>
    
      <t>
      The requirements for UPPs are described below:
      </t>
        
      <t>
      <list style="hanging">
        <t hangText="ARCH-Req-1:">
        IPv4, IPv6, Ethernet and Unstructured Packet Data Unit (PDU) are supported in the 5G system. 
        In short, UPP must support all of these PDU session types. This is refered in the section 3.1 of 
        <xref target="TS.23.501-3GPP"/>.
        </t>
    
        <t hangText="ARCH-Req-2:">
        The 5G system allows to deploy multiple UPFs as anchors for a single PDU session, and a single PDU session 
        supports multi-homing for such anchor UPFs. Thus, UPP should be a multipoint-to-point tunnel in UL/DL to 
        support the case of multihoming with a single PDU session. As examples of use cases that use multi-homing for 
        a single PDU session, SSC Mode 1 and 2 described in the section 5.6.4 and 5.6.9 of <xref target="TS.23.501-3GPP"/>. 
        Corresponding to specifications of SSC Mode 1 and 2, multi-homing for Ethernet type PDU session.
        </t>
    
        <t hangText="ARCH-Req-3:">
        The 5G system potentially supports flexible UPF selection for PDU compared to persistent S/P-GW in 4G. The 
        appropriate UPFs are selected for a PDU session based on parameters and information such as UPF's dynamic 
        load or UE location information. Examples of parameters and information are described in the section 6.3.3 
        of <xref target="TS.23.501-3GPP"/>.
        </t>
    
        <t hangText="ARCH-Req-4:">
        There's no limitation for number of UPFs in a data plane path. This specification is described in the section 
        8.3.1 of <xref target="TS.23.501-3GPP"/>. Putting multiple UPFs in a data path enables 
        to deploy functions as Application Function required through the path. In addition, putting multiple UPFs 
        as anchors closed to UEs' site may enable to make data path more efficient. This usage is refered in the 6.5 of 
        <xref target="TS.22.261-3GPP"/>. It is exptected that multiple UPFs with per session tunnel handling for a PDU 
        session becomes complicated task more and more for a SMF by increasing number of UPFs, and UPP shall support to 
        aggregate several PDU sessions into a tunnel or shall be a session-less tunnel.
        </t>
    
        <t hangText="ARCH-Req-5:">
        A PDU session is able to aggregate multiple QoS Flow indicated with QFI. Against to the previous generation, 
        5G enables UPF to multiprex QoS Flows, equivarent with IP-CAN bearers in  the previous generation, into one 
        single PDU session. That means that a single tunnel includes multiple QFIs contrast to just one QoS Flow 
        (a bearer) to one tunnel before 5G. This specification is described in 5.7.1 of <xref target="TS.23.501-3GPP"/>.
        </t>
    
        <t hangText="ARCH-Req-6:">
        A unique identifier in a 5G network is allocated to each UE, and its PDU sessions are handled based on the 
        identifiable information such as subscription information. There are cases where a PDU session traverses 
        multiple UPFs and enforced some processes at each UPF. This means that each UPF is required to identify the 
        same PDU session and looks up the poilcy rules. For avoiding this redandant identifications, UPP might be 
        required to convey identifiers represeinting several types of information. The specification regarding to 
        identifiers is described in the section 5.9 of <xref target="TS.23.501-3GPP"/>.
        </t>
    
        <t hangText="ARCH-Req-7:">
        UPF supports several functionalities for handling PDU sessions, and some of them potentially have requiremts 
        for UPP. For example, UPF supports packet routing and forwarding includes support of multi-homed PDU session. 
        Also, UPF support QoS handling for user plane, e.g., UL/DL rate enforcement or QoS marking in DL, and UPP 
        should be able to present QoS class with DSCP or CoS in the outer most header. The functionalities of UPF is 
        described in the section 6.2.3 of <xref target="TS.23.501-3GPP"/>.
        </t>

        <t hangText="ARCH-Req-8:">
        UPF shall detect user plane depending on information indecated by SMF. User data traffic is detected with 
        combination of the following information:
          <list style="symbols">
          <t>For IPv4 or IPv6 PDU Session type
            <list style="symbols">
            <t>PDU Session</t>
            <t>QFI</t>
            <t>Application Identifier: The Application ID is an index to a set of application detection rules configured in UPF</t>
            </list>
          </t>
          <t>For Ethernet PDU Session type
            <list style="symbols">
            <t>PUD Session</t>
            <t>QFI</t>
            <t>Ethernet Packet Filter Set:
              <list style="symbols">
                <t>Source/destination MAC address</t>
                <t>Ethertype as defined in IEEE 802.3</t>
                <t>Customer-VLAN tag(C-TAG) and/or Service-VLAN tag(S-TAG) VID fields as defined in IEEE 802.1Q</t>
                <t>Customer-VLAN tag(C-TAG) and/or Service-VLAN tag(S-TAG) PCP/DEI fields as defined in IEEE 802.1Q</t>
                <t>IP Packet Filter Set, in case Ethertype indicates IPv4/IPv6 payload</t>
                <t>Packet filter direction</t>
              </list>
            </t>
            </list>
          </t>
          </list>
        Such information for traffic detection (Traffic Detection Information) is described in the section 5.8.2.4 of 
        <xref target="TS.23.501-3GPP"/>.
        </t>
           
<!-- Any more requirements? -->
                                                                        
      </list>
      </t>
      </section>
    </section>
                                          
      
    <section anchor="criteria" title="Criteria">
      <t>
      TBD
      </t>
    </section>

    <section title="Security Consideration">
    <t>TBD</t>
    </section>
    
    
    <section title="IANA Considerations">
    <t>TBD</t>
    </section>
    
    <section title="Acknowledgement">
    <t>
    The author would like to thank #TBD# for reviewing various iterations of
    the document and for providing content into various sections. 
    </t>
    </section>

  </middle>

  <!-- ***** BACK MATTER ***** -->

  <back>
    <references title="Normative References">
    
    &RFC2119;
    </references>
    
    <references title="Informative References">
<!--    
    &RFC1027;
    &RFC2234;
    &RFC3513;
    &RFC4861;
    &RFC4941;
    &RFC6830;
    &RFC6831;
    &RFC6832;
    &RFC6833;
    &RFC6835;
    &RFC6836;
    &RFC7215;
    &RFC8060;
    &RFC8061;
    &RFC8111;
    &RFC8112;
    &I-D.draft-ietf-spring-segment-routing;
    &I-D.draft-ietf-6man-segment-routing-header;
    &I-D.draft-ietf-dmm-srv6-mobile-uplane;
    &I-D.draft-filsfils-spring-srv6-network-programming;
    &I-D.draft-xuclad-spring-sr-service-chaining;
    &I-D.draft-ietf-lisp-rfc6830bis;
    &I-D.draft-ietf-lisp-rfc6833bis;
    &I-D.draft-farinacci-lisp-mobile-network;
    &I-D.draft-ietf-lisp-eid-mobility;
    &I-D.draft-ietf-lisp-pubsub;
    &I-D.draft-ietf-lisp-mn;
    &I-D.draft-ietf-lisp-introduction;
    &I-D.draft-rodrigueznatal-ila-lisp;
    &I-D.draft-kouvelas-lisp-map-server-reliable-transport;
    &I-D.draft-gundavelli-dmm-mfa;
    &I-D.draft-lapukhov-bgp-ila-afi;
    &I-D.draft-homma-dmm-5gs-id-loc-coexistence;

      <reference anchor='ILAGRPS'>
        <front>
        <title>Identifier Group in ILA (To be published)</title>
        <author initials="T." surname="Herbert" fullname="Tom Herbert">
        <organization/>
        </author>
        <date/>
        </front>
      </reference>
-->
    &I-D.draft-bogineni-dmm-optimized-mobile-user-plane;

      <reference anchor='TR.29.891-3GPP'>
        <front>
        <title>5G System ? Phase 1, CT WG4 Aspects, 3GPP TR 29.891 v15.0.0</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="December" year="2017"/>
        </front>
      </reference>

      <reference anchor='TS.29.244-3GPP'>
        <front>
        <title>Interface between the Control Plane and the User Plane Nodes; Stage 3, 3GPP TS 29.244 v15.0.0</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="December" year="2017"/>
        </front>
      </reference>

      <reference anchor='TS.29.281-3GPP'>
        <front>
        <title>GPRS Tunneling Protocol User Plane (GTPv1-U), 3GPP TS 29.281 v15.1.0</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="December" year="2017"/>
        </front>
      </reference>

      <reference anchor='TS.23.203-3GPP'>
        <front>
        <title>Policy and Charging Control Architecture, 3GPP TS 23.203 v2.0.1</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="December" year="2017"/>
        </front>
      </reference>

      <reference anchor='TS.23.501-3GPP'>
        <front>
        <title>System Architecture for 5G System; Stage 2, 3GPP TS 23.501 v2.0.1</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="December" year="2017"/>
        </front>
      </reference>

      <reference anchor='TS.23.502-3GPP'>
        <front>
        <title>Procedures for 5G System; Stage 2, 3GPP TS 23.502, v2.0.0</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="December" year="2017"/>
        </front>
      </reference>

      <reference anchor='TS.23.503-3GPP'>
        <front>
        <title>Policy and Charging Control System for 5G Framework; Stage 2, 3GPP TS 23.503 v1.0.0</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="December" year="2017"/>
        </front>
      </reference>

      <reference anchor='TS.38.300-3GPP'>
        <front>
        <title>NR and NG-RAN Overall Description: Stage 2, 3GPP TS 38.300 v2.0.0</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="December" year="2017"/>
        </front>
      </reference>

      <reference anchor='TS.38.401-3GPP'>
        <front>
        <title>NG-RAN: Architecture Description, 3GPP TS 38.401 v1.0.0</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="December" year="2017"/>
        </front>
      </reference>
      
      <reference anchor='TS.22.261-3GPP'>
        <front>
        <title>Service requirements for 5G system stage 1, 3GPP TS 22.261 v15.4.0</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="March" year="2018"/>
        </front>
      </reference>

      <reference anchor='CP-180116-3GPP'>
        <front>
        <title>LS on user plane protocol study</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="March" year="2018"/>
        </front>
      </reference>

      <reference anchor='CP-173160-3GPP'>
        <front>
        <title>New Study Item on User Plane Protocol in 5GC</title>
        <author>
        <organization>
        3rd Generation Partnership Project (3GPP)
        </organization>
        </author>
        <date month="December" year="2017"/>
        </front>
      </reference>

    </references>



  </back>

</rfc>
